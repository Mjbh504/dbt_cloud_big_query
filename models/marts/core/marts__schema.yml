version: 2

models:
  - name: dim_date
    description: "Calendario de fechas"
    columns:
      - name: date_day
        tests: [not_null, unique]

  - name: dim_product
    description: "Dimensi√≥n de productos"
    columns:
      - name: product_id
        tests: [not_null, unique]
      - name: product_name
        tests: [not_null]

  - name: dim_customer
    description: "Dimensi√≥n de clientes"
    columns:
      - name: user_id
        tests: [not_null, unique]
      - name: email
        tests: [not_null]

  - name: fact_sales
    description: "Hechos de ventas a nivel √≠tem (1 fila = 1 order_item)"
    columns:
      - name: order_item_id
        tests: [not_null, unique]

      - name: order_date
        tests:
          - not_null
          - relationships:
              to: ref('dim_date')
              field: date_day

      - name: product_id
        tests:
          - not_null
          - relationships:
              to: ref('dim_product')
              field: product_id

      - name: user_id
        tests:
          - not_null
          - relationships:
              to: ref('dim_customer')
              field: user_id

      - name: revenue
        tests: [not_null]
<<<<<<< HEAD
  - name: fact_sales
    columns:
      - name: profit
        tests: [not_null]
      - name: margin_pct
        tests:
          - not_null
          - accepted_values:
              arguments:
                values: []     # placeholder para habilitar "conditions" en v1.8+ si usas constraints
          - relationships:     # truco: elimina si tu versi√≥n no soporta constraints condicionales
              to: ref('dim_product')   # üí° Si tu dbt no soporta condiciones aqu√≠, omite este bloque
              field: product_id
  - name: fact_sales
    description: Tabla de hechos de ventas con m√©tricas calculadas
    columns:
      - name: profit
        description: Ganancia por √≠tem (revenue - cost)
        tests:
          - not_null

      - name: margin_pct
        description: Margen de ganancia porcentual
        tests:
          - not_null
          - margin_pct_between_0_and_1
=======
>>>>>>> c1814098ce2fc98ad7a262a1d7f3adcba0c3717e
